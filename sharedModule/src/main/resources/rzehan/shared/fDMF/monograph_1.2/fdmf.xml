<dmf>

    <pattern name="FILENAME">
        <description>Vzor pro obecný soubor/adresář. Určuje povolené znaky v názvech souborů/adresářů.</description>
        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">[a-z_\-\.]+</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="true">[a-z_\-\.]+</expression>
    </pattern>

    <pattern name="INFO_FILENAME_FOR_PSP_ID_DETECTION">
        <description>Vzor pro nalezení souboru INFO pouze za účelem získání PSP-ID z jeho obsahu.</description>

        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">info_.+\.xml</expression>
        <expression caseSensitive="false">info\.xml</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="true">info_.+\.xml</expression>
        <expression caseSensitive="true">info\.xml</expression>


    </pattern>

    <pattern name="INFO_FILENAME">
        <description>Vzor pro jméno souboru INFO.</description>

        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">info_${PSP_ID}\.xml</expression>
        <expression>info\.xml</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="true">info_${PSP_ID}\.xml</expression>
        <expression>info\.xml</expression>

    </pattern>

    <pattern name="PRIMARY-METS_FILENAME">
        <description>Vzor pro jméno souboru PRIMARY-METS.</description>

        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">mets_${PSP_ID}\.xml</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="true">mets_${PSP_ID}\.xml</expression>
    </pattern>

    <!--jako predchozi podobne i
    CHECKSUM_FILENAME
    TOLERATED_TL_FILENAME
    -->

    <pattern name="SECONDARY-METS-DIR_FILENAME">
        <description>Vzor pro jméno adresáře SECONDARY-METS-DIR.</description>

        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">amdsec</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="true">amdsec</expression>

    </pattern>

    <!--podobne i
    OCR-TEXT-DIR_FILENAME
    OCR-ALTO-DIR_FILENAME
    MASTER-COPY-DIR_FILENAME
    USER-COPY-DIR_FILENAME
    -->


    <pattern name="SECONDARY-METS_FILENAME">
        <description>Vzor pro jména souborŮ SECONDARY-METS v rámci adresáře SECONDARY-METS-DIR.</description>

        <!--per<=1.4, mon<=1.0-->
        <!--<expression caseSensitive="false">amd_mets_${PSP_ID}_[0-9]+\.xml</expression>-->

        <!--per>=1.5, mon>=1.1-->
        <expression caseSensitive="false">amd_mets_${PSP_ID}_[0-9]+\.xml</expression>


    </pattern>

    <!--podobne i
    OCR-TEXT_FILENAME
    OCR-ALTO_FILENAME
    MASTER-COPY_FILENAME
    USER-COPY_FILENAME
    -->

    <variable name="PSP_DIR" type="File">
        <evaluationFunction name="PROVIDED">
            <!--tj. musi byt dodano pres GUI nebo CLI-->
            <params>
                <param name="var_name">PSP_DIR</param>
            </params>
        </evaluationFunction>
    </variable>

    <variable name="INFO_FILES" type="file_list">
        <evaluationFunction name="FIND_FILES_IN_DIR_BY_PATTERN">
            <params>
                <param name="dir">
                    <variable name="PSP_DIR"/>
                </param>
                <param name="pattern">
                    <pattern name="INFO_FILENAME"/>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--
        podobne
        PRIMARY-METS_FILES
        CHECKSUM_FILES
        TOLERATED_TL_FILES
    -->


    <variable name="INFO_FILE" type="File">
        <evaluationFunction name="RETURN_FIRST_ITEM">
            <params>
                <param name="list">
                    <variable name="INFO_FILES"/>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--
        podobne
        PRIMARY-METS_FILE
        CHECKSUM_FILE
    -->


    <variable name="SECONDARY-METS-DIR_FILES" type="file_list">
        <evaluationFunction name="FIND_FILES_IN_DIR_BY_PATTERN">
            <params>
                <param name="dir">
                    <variable name="PSP_DIR"/>
                </param>
                <param name="pattern">
                    <pattern name="SECONDARY-METS-DIR_FILENAME"/>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--
    podobne
    OCR-TEXT-DIR_FILES
    OCR-ALTO-DIR_FILES
    MASTER-COPY-DIR_FILES
    USER-COPY-DIR_FILES
    -->


    <variable name="SECONDARY-METS-DIR_FILE" type="File">
        <evaluationFunction name="RETURN_FIRST_ITEM">
            <params>
                <param name="list">
                    <variable name="SECONDARY-METS-DIR_FILES"/>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--
    podobne
    OCR-TEXT-DIR_FILE
    OCR-ALTO-DIR_FILE
    MASTER-COPY-DIR_FILE
    USER-COPY-DIR_FILE
    -->

    <variable name="SECONDARY-METS_FILES" type="file_list">
        <evaluationFunction name="FIND_FILES_IN_DIR_BY_PATTERN">
            <params>
                <param name="dir">
                    <variable name="SECONDARY-METS-DIR_FILE"/>
                </param>
                <param name="pattern">
                    <pattern name="SECONDARY-METS_FILENAME"/>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--
    podobne
    OCR-TEXT_FILES
    OCR-ALTO_FILES
    MASTER-COPY_FILES
    USER-COPY_FILES
    -->


    <!--soubory XSD-->

    <variable name="INFO_XSD_FILE" type="File">
        <evaluationFunction name="PROVIDED">
            <!--tj. musi byt dodano pres GUI nebo CLI na zaklade konkretni fDMF-->
            <params>
                <param name="var_name">INFO_XSD_FILE</param>
            </params>
        </evaluationFunction>
    </variable>

    <!--TODO: podobne ostatni XSD-->


    <!--zpracování INFO-->
    <variable name="INFO_ITEMTOTAL" type="Integer">
        <description>hodnota /info/itemlist/@itemtotal ze souboru INFO</description>
        <evaluationFunction name="GET_INT_BY_XPATH">
            <params>
                <param name="file">
                    <variable name="INFO_FILE"/>
                </param>
                <param name="xpath">
                    <xpath>/info/itemlist/@itemtotal</xpath>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <variable name="INFO_ITEMS" type="string_list">
        <description>seznam hodnot /info/itemlist/item ze souboru INFO</description>
        <evaluationFunction name="GET_STRING_LIST_BY_XPATH">
            <params>
                <param name="file">
                    <variable name="INFO_FILE"/>
                </param>
                <param name="xpath">
                    <xpath>/info/itemlist/item</xpath>
                </param>
            </params>
        </evaluationFunction>
    </variable>

    <!--TEST, takhle by mohlo definovani promene nove vypadat se obema typy parametru  (hodnota, vzor) a obema typy zapisu - odkazem a definici-->

    <variable name="NECO" type="file_list">
        <evaluationFunction name="EVALUATE_NECO">
            <params>

                <!--VALUE-->

                <!--hodnota odkazem na promennou-->
                <param-value name="dir">
                    <variable-ref name="PSP_DIR"/>
                </param-value>

                <!--hodnota pres definici (anonymni promenna)-->
                <!--todo: jeste zvazit, nejspis nebude potreba-->
                <param-value name="psp_dir">
                    <value type="File">
                        <evaluationFunction name="PROVIDED">
                            <!--tj. musi byt dodano pres GUI nebo CLI-->
                            <params>
                                <param name="var_name">PSP_DIR</param>
                            </params>
                        </evaluationFunction>
                    </value>
                </param-value>

                <!--hodnota primo - ale jenom String, Integer, soubory ani zadne seznamy nepovolim-->
                <param-value name="day">
                    <value type="String">Monday</value>
                </param-value>

                <param-value name="count">
                    <value type="Integer">7</value>
                </param-value>

                <!--PATTERN-->


                <!--pattern odkazem-->
                <param-pattern name="pattern1">
                    <pattern-ref name="INFO_FILENAME"/>
                </param-pattern>

                <!--pattern definici-->
                <param-pattern name="pattern2">
                    <pattern>
                        <expression caseSensitive="true">info_${PSP_ID}\.xml</expression>
                        <expression>info\.xml</expression>
                    </pattern>
                </param-pattern>

            </params>
        </evaluationFunction>
    </variable>

    <!--TEST: ruzne moznosti hodnoty pres definici-->


</dmf>