<imageUtils>
    <imageUtil name="JPYLYZER">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <!--zdrojove kody z https://github.com/openpreserve/jpylyzer/releases a spousteni pres python-->
            <!--http://jpylyzer.openpreservation.org//installation.html-->
            <operatingSystem name="MAC">
                <command>python ${PATH}jpylyzer.py --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="MAC">
                <command>python ${PATH}jpylyzer.py jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="IMAGE_MAGICK">
        <versionDetection>
            <!--https://gist.github.com/Lammerink/3926636-->
            <operatingSystem name="LINUX">
                <command>convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>magick.exe convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>
            <!--http://www.imagemagick.org/script/binary-releases.php-->
            <!--instalace pres MacPorts-->
            <!--bohuzel ale jen verze 6.9.9, ktera nedava vystup v xml-->
            <!--mozna pouzit https://github.com/mtna/imagemagick-identify-parser-->
            <!--<operatingSystem name="MAC">
                <command>${PATH}convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>-->
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>magick.exe identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <!--<operatingSystem name="MAC">
                <command>${PATH}identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>-->
        </execution>
    </imageUtil>

    <imageUtil name="JHOVE">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>jhove --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?m)^.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <!--TODO:
                //https://github.com/openpreserve/jhove/issues/32
                //until then temporary fix with configuration file-->
                <command>jhove.bat --version -c C:\Users\Lenovo\Documents\software\jhove-1_11\jhove\conf\jhove.conf
                </command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?m)^.*$</regexp>
                </parser>
            </operatingSystem>
            <!--instalace podle http://jhove.openpreservation.org/getting-started/-->
            <!--stahnout jhove-latest.jar a double click spusti instalator (predpoklad jre)-->
            <operatingSystem name="MAC">
                <command>${PATH}jhove --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Jhove \(.*\)</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>jhove -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <!--TODO:
                //https://github.com/openpreserve/jhove/issues/32
                //until then temporary fix with configuration file-->
                <command>jhove.bat -h XML -m jpeg2000-hul -k ${IMAGE_FILE} -c
                    C:\Users\Lenovo\Documents\software\jhove-1_11\jhove\conf\jhove.conf
                </command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="MAC">
                <command>${PATH}jhove -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="KAKADU">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>kdu_expand -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>kdu_expand.exe -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
            <!--demo app does not work in macOS 10.12 Sierra, so not tested-->
            <operatingSystem name="MAC">
                <command>${PATH}kdu_expand -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>kdu_expand -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>kdu_expand.exe -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <!--demo app does not work in macOS 10.12 Sierra, so not tested-->
            <operatingSystem name="LINUX">
                <command>${PATH}kdu_expand -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>


</imageUtils>