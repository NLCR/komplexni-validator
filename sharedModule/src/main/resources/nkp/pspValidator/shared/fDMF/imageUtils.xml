<imageUtils>
    <imageUtil name="JPYLYZER">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="IMAGE_MAGICK">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>magick.exe convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>magick.exe identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="JHOVE">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>jhove --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?m)^.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <!--TODO:
                //https://github.com/openpreserve/jhove/issues/32
                //until then temporary fix with configuration file-->
                <command>jhove.bat -c C:\Users\Martin\Documents\PspValidator\jhove-1_11\jhove\conf\jhove.conf
                    --version
                </command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?m)^.*$</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>jhove -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <!--TODO:
                //https://github.com/openpreserve/jhove/issues/32
                //until then temporary fix with configuration file-->
                <command>jhove.bat -c C:\Users\Martin\Documents\PspValidator\jhove-1_11\jhove\conf\jhove.conf</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="KAKADU">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>kdu_expand -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>kdu_expand.exe -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>kdu_expand -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>kdu_expand.exe -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>.*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>


</imageUtils>