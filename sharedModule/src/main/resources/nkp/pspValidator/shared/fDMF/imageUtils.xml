<imageUtils>
    <imageUtil name="JPYLYZER">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>${PATH}jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}jpylyzer --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <!--zdrojove kody z https://github.com/openpreserve/jpylyzer/releases a spousteni pres python-->
            <!--http://jpylyzer.openpreservation.org//installation.html-->
            <operatingSystem name="MAC">
                <command>python ${PATH}jpylyzer.py --version</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>${PATH}jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}jpylyzer jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="MAC">
                <command>python ${PATH}jpylyzer.py jp2In ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="IMAGE_MAGICK">
        <versionDetection>
            <!--https://gist.github.com/Lammerink/3926636-->
            <operatingSystem name="LINUX">
                <command>${PATH}convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <!--<regexp>ImageMagick\s\S*\s\S*</regexp>-->
                    <regexp>ImageMagick [0-9\.\-]+</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}magick.exe convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <!--<regexp>ImageMagick\s\S*\s\S*</regexp>-->
                    <regexp>ImageMagick [0-9\.\-]+</regexp>
                </parser>
            </operatingSystem>
            <!--TODO: vlastne blbost, nepotrebuju tady xml-->
            <!--http://www.imagemagick.org/script/binary-releases.php-->
            <!--instalace pres MacPorts-->
            <operatingSystem name="MAC">
                <command>${PATH}convert -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>ImageMagick\s\S*\s\S*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>${PATH}identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}magick.exe identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="MAC">
                <command>${PATH}identify -verbose ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="JHOVE">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>${PATH}jhove --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <!--<regexp>Jhove \(.*\)</regexp>-->
                    <regexp>Rel\. [0-9\.]+</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <!--TODO: v aplikaci vyzadovat minimalni verzi 1.14
                http://openpreservation.org/news/jhove-1-14-released/
                instalace: stahnout jhove-latest.jar (instalator) a spustit double click nebo java -jar jhove-latest.jar
                -->
                <command>${PATH}jhove.bat --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Rel\. [0-9\.]+</regexp>
                    <!--<regexp>Jhove \(.*\)</regexp>-->
                    <!--<regexp>(?m)^.*$</regexp>-->
                </parser>
            </operatingSystem>
            <!--instalace podle http://jhove.openpreservation.org/getting-started/-->
            <!--stahnout jhove-latest.jar a double click spusti instalator (predpoklad jre)-->
            <operatingSystem name="MAC">
                <command>${PATH}jhove --version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Jhove \(.*\)</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>${PATH}jhove -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}jhove.bat -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="MAC">
                <command>${PATH}jhove -h XML -m jpeg2000-hul -k ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>(?s)&lt;\?xml.*$</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>

    <imageUtil name="KAKADU">
        <versionDetection>
            <operatingSystem name="LINUX">
                <command>${PATH}kdu_expand -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <!--<regexp>Current core system version is \S*</regexp>-->
                    <regexp>v[\.0-9]+</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}kdu_expand.exe -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <!--<regexp>Current core system version is \S*</regexp>-->
                    <regexp>v[\.0-9]+</regexp>
                </parser>
            </operatingSystem>
            <!--demo app does not work in macOS 10.12 Sierra, so not tested-->
            <operatingSystem name="MAC">
                <command>${PATH}kdu_expand -version</command>
                <parser>
                    <stream>STDOUT</stream>
                    <regexp>Current core system version is \S*</regexp>
                </parser>
            </operatingSystem>
        </versionDetection>
        <execution>
            <operatingSystem name="LINUX">
                <command>${PATH}kdu_expand -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <operatingSystem name="WINDOWS">
                <command>${PATH}kdu_expand.exe -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
            <!--demo app does not work in macOS 10.12 Sierra, so not tested-->
            <operatingSystem name="LINUX">
                <command>${PATH}kdu_expand -i ${IMAGE_FILE}</command>
                <parser>
                    <stream>STDERR</stream>
                    <regexp>(?s).*</regexp>
                </parser>
            </operatingSystem>
        </execution>
    </imageUtil>


</imageUtils>